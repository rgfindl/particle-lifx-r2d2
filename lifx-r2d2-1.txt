// This #include statement was automatically added by the Particle IDE.
#include "spark-dallas-temperature/spark-dallas-temperature.h"

// This #include statement was automatically added by the Particle IDE.
#include "OneWire/OneWire.h"// This #include statement was automatically added by the Particle IDE.

DallasTemperature dallas(new OneWire(D2));
int pwr = A5;

float fault = -100.0;

void setup(){
    Serial.begin(9600);
    dallas.begin();
    pinMode(pwr, OUTPUT); // The pin powering the photoresistor is output (sending out consistent power)
}

void loop(){
    digitalWrite(pwr, HIGH);
    dallas.requestTemperatures();
    
    
    float tempF = dallas.getTempFByIndex( 0 );
    if (tempF > fault) {
        char tempFStr[64];
        sprintf(tempFStr, "%2.2f", tempF);
        Particle.publish("outside-temp-f", tempFStr, 60, PRIVATE);
        Serial.println(tempFStr);
    }
    
    delay(5000);
}